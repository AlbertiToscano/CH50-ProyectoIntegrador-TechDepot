import"./footer-BO6_J53n.js";document.addEventListener("DOMContentLoaded",function(){this.getElementById("productosCarrito"),n("producto"),n("piezaDePC");function n(t){if(c(t)!=null){const e=c(t),i=document.getElementById("productosCarrito");let a=0;e.forEach(d=>{const s=document.createElement("tr");s.innerHTML=`
          <td><img src="${d.imagen}" alt="${d.titulo}" class="img-fluid imgProducto"></td>
          <td>${d.titulo.length>40?d.titulo.substring(0,37)+"...":d.titulo}</td>
          <td class="precio">$${d.precio.toFixed(2)}</td>
          <td>
            <div id="${d.id}" class="input-group">
              <button class="btn btn-outline-secondary" type="button" onclick="decrementarCantidad(this)">-</button>
              <span id="cantidad${d.id}"  class="cantidad">${d.cantidad}</span>
              <button class="btn btn-outline-secondary" type="button" onclick="incrementarCantidad(this)">+</button>
            </div>
          </td>
          <td class="total${d.id}">$${(d.precio*d.cantidad).toFixed(2)}</td>
          <td><button id="borrar${d.id}" class="btn btn-link" onclick="eliminarProducto(event)">
            <img src="/icons/icono-basura.png" alt="Eliminar" style="width: 20px; height: 20px;">
          </button></td>
        `,i.appendChild(s),a+=d.precio,f(d,t),C(d,t),b(d,t)}),document.getElementById("totalCompra").textContent=`$${a.toFixed(2)}`}}window.decrementarCantidad=function(t){const e=t.closest("tr").querySelector(".cantidad");e.value>1&&(e.value=parseInt(e.value)-1)},window.incrementarCantidad=function(t){const e=t.closest("tr").querySelector(".cantidad");e.value=parseInt(e.value)+1},window.eliminarProducto=function(t){t.target.closest("tr").remove()},document.getElementById("botonPagar").addEventListener("click",()=>{window.location.href="/src/pages/pagar/pagar.html"}),r()});const c=n=>JSON.parse(localStorage.getItem(n));function l(n,o){const t=c(o);if(t){const e=t.findIndex(d=>d.id===n.id);return t[e].cantidad}}function m(n,o){const t=document.getElementById(`cantidad${n.id}`),e=l(n,o);t.textContent=e}function u(n,o){const t=c(o);if(t){const e=t.findIndex(a=>a.id===n.id),i=t;return e===-1?i.push(getProducto(n)):i[e].cantidad++,localStorage.setItem(o,JSON.stringify(i)),i[e].cantidad}}function g(n,o){const t=c(o);if(t){const e=t.findIndex(a=>a.id===n.id),i=t;return i[e].cantidad--,localStorage.setItem(o,JSON.stringify(i)),i[e].cantidad}}function r(){const n=c("piezaDePC"),o=c("producto"),t=n,e=o;let i=0;t!=null&&t.forEach(a=>{i+=a.cantidad*a.precio}),e!=null&&e.forEach(a=>{i+=a.cantidad*a.precio}),document.getElementById("totalCompra").textContent=`$${i.toFixed(2)}`}const f=(n,o)=>{const t=document.getElementById(n.id),e=document.querySelector(`.total${n.id}`);t.getElementsByClassName("btn")[1].addEventListener("click",()=>{let i=u(n,o),a=n.precio*i;e.textContent="$"+a.toFixed(2),r(),m(n,o)})},C=(n,o)=>{const t=document.getElementById(n.id),e=document.querySelector(`.total${n.id}`);t.getElementsByClassName("btn")[0].addEventListener("click",()=>{if(l(n,o)>1){const a=g(n,o);let d=n.precio*a;e.textContent="$"+d.toFixed(2),r(),m(n,o)}})};function b(n,o){const t=document.getElementById(`borrar${n.id}`);let e=c(o);e&&t.addEventListener("click",()=>{e=c(o);const i=e.findIndex(a=>a.id===n.id);e.splice(i,1),localStorage.setItem(o,JSON.stringify(e)),I(n),r()})}const I=n=>{let o=localStorage.getItem("productosComprados"),t=localStorage.getItem("unitario");o=o.split(","),t=t.split(","),console.log(o);const e=o.length;if(o){for(let i=0;i<=e;i++){console.log(i);let a=o.findIndex(d=>d===n.id);a!=-1&&o.splice(a,1)}localStorage.setItem("productosComprados",o)}if(t){let i=t.findIndex(a=>a===n.id);t.splice(i,1)}localStorage.setItem("unitario",t)};
